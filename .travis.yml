env:
  global:
    - CONAN_USERNAME: "rhololkeolke"
    - CONAN_LOGIN_USERNAME: "rhololkeolke"
    - CONAN_CHANNEL: "testing"
    - CONAN_UPLOAD: "https://api.bintray.com/conan/rhololkeolke/public-conan"
    - CONAN_STABLE_BRANCH_PATTERN: "stable/*"
    - CONAN_UPLOAD_ONLY_WHEN_STABLE: 1
    - CONAN_ARCHS: "x86_64"

linux: &linux
  os: linux
  dist: xenial
  sudo: required
  language: python
  python: "3.7"
  install:
    - pip install -U conan conan_package_tools
  addons:
    apt:
      sources:
        - llvm-toolchain-xenial-8
        - llvm-toolchain-xenial-7
      packages:
        - figlet
        
matrix:
  include:
      - <<: *linux
        env: CONAN_GCC_VERSIONS=7 CC=/usr/bin/gcc-7 CXX=/usr/bin/g++-7 PACKAGES="gcc-7 g++-7"
      - <<: *linux
        env: CONAN_GCC_VERSIONS=8 CC=/usr/bin/gcc-8 CXX=/usr/bin/g++-8 PACKAGES="gcc-8 g++-8"
      - <<: *linux
        env: CONAN_CLANG_VERSIONS=7.1 CC=/usr/bin/clang-7 CXX=/usr/bin/clang++-7 PACKAGES=clang-7
      - <<: *linux
        env: CONAN_CLANG_VERSIONS=8 CC=/usr/bin/clang-8 CXX=/usr/bin/clang++-8 PACKAGES=clang-8

before_install:
  # Install the proper libstdc++ version
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get update -q
  - sudo apt-get install libstdc++-7-dev ${PACKAGES} -y
  # Install later CMake version
  - figlet "CMake"
  - wget https://github.com/Kitware/CMake/releases/download/v3.14.3/cmake-3.14.3-Linux-x86_64.sh
  - chmod +x cmake-3.14.3-Linux-x86_64.sh
  - sudo ./cmake-3.14.3-Linux-x86_64.sh --prefix=/usr/local/ --skip-license --exclude-subdir
  - rm cmake-3.14.3-Linux-x86_64.sh
  # Double check versions
  - cmake --version

install:
  - chmod +x .travis/install.sh
  - ./.travis/install.sh

script:
  - chmod +x .travis/run.sh
  - ./.travis/run.sh
  
